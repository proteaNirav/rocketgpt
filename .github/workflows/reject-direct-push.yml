name: Reject direct pushes to main

on:
  push:
    branches: [main]

jobs:
  guard:
    runs-on: ubuntu-latest
    steps:
      - name: Check commit message
        run: |
          msg="${{ github.event.head_commit.message }}"
          if [[ "$msg" != Merge*pull*request* ]]; then
            echo "Direct pushes to main are not allowed. Use PRs."
            exit 1
          fi
