{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import type { NextRequest } from \"next/server\";\nimport { NextResponse } from \"next/server\";\n\n/**\n * Central CORS for Edge endpoints\n * - Handles OPTIONS preflight\n * - Adds CORS headers on all responses\n * - Passthrough of Authorization and common auth headers\n *\n * Scope: /api/edge/*\n */\n\nconst ALLOW_ORIGIN = \"*\"; // Phase 1: permissive; tighten in Phase 2\nconst ALLOW_METHODS = \"GET,POST,OPTIONS\";\nconst ALLOW_HEADERS = \"Content-Type, Authorization\";\nconst MAX_AGE = \"600\";\n\nfunction applyCorsHeaders(res: NextResponse) {\n  res.headers.set(\"Access-Control-Allow-Origin\", ALLOW_ORIGIN);\n  res.headers.set(\"Access-Control-Allow-Methods\", ALLOW_METHODS);\n  res.headers.set(\"Access-Control-Allow-Headers\", ALLOW_HEADERS);\n  res.headers.set(\"Access-Control-Max-Age\", MAX_AGE);\n  return res;\n}\n\nexport async function middleware(req: NextRequest) {\n  // Preflight\n  if (req.method === \"OPTIONS\") {\n    const preflight = new NextResponse(null, { status: 204 });\n    return applyCorsHeaders(preflight);\n  }\n\n  // Forward auth-related headers (optional; explicit in case upstream requires)\n  const fwd = new Headers(req.headers);\n  // (No mutation needed for Authorization; kept to signal intent)\n  // fwd.set(\"Authorization\", req.headers.get(\"Authorization\") ?? \"\");\n\n  const res = NextResponse.next({\n    request: { headers: fwd },\n  });\n\n  return applyCorsHeaders(res);\n}\n\n/** Limit this middleware to Edge API paths only */\nexport const config = {\n  matcher: [\"/api/edge/:path*\"],\n};\r\n"],"names":[],"mappings":";;;;;;AACA;AAAA;;AAEA;;;;;;;CAOC,GAED,MAAM,eAAe,KAAK,0CAA0C;AACpE,MAAM,gBAAgB;AACtB,MAAM,gBAAgB;AACtB,MAAM,UAAU;AAEhB,SAAS,iBAAiB,GAAiB;IACzC,IAAI,OAAO,CAAC,GAAG,CAAC,+BAA+B;IAC/C,IAAI,OAAO,CAAC,GAAG,CAAC,gCAAgC;IAChD,IAAI,OAAO,CAAC,GAAG,CAAC,gCAAgC;IAChD,IAAI,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC1C,OAAO;AACT;AAEO,eAAe,WAAW,GAAgB;IAC/C,YAAY;IACZ,IAAI,IAAI,MAAM,KAAK,WAAW;QAC5B,MAAM,YAAY,IAAI,gMAAY,CAAC,MAAM;YAAE,QAAQ;QAAI;QACvD,OAAO,iBAAiB;IAC1B;IAEA,8EAA8E;IAC9E,MAAM,MAAM,IAAI,QAAQ,IAAI,OAAO;IACnC,gEAAgE;IAChE,oEAAoE;IAEpE,MAAM,MAAM,gMAAY,CAAC,IAAI,CAAC;QAC5B,SAAS;YAAE,SAAS;QAAI;IAC1B;IAEA,OAAO,iBAAiB;AAC1B;AAGO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAmB;AAC/B"}}]
}